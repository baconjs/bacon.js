(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=[].slice,R={}.hasOwnProperty,U=function(e,t){function r(){this.constructor=e}for(var n in t)R.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},z=function(e,t){return function(){return e.apply(t,arguments)}};typeof module!="undefined"&&module!==null?(module.exports=e={},e.Bacon=e):this.Bacon=e={},e.fromBinder=function(t,n){return n==null&&(n=F.id),new o(function(r){var i;return i=t(function(){var t,o,u,a,f,l,c;t=1<=arguments.length?q.call(arguments,0):[],a=n.apply(null,t),a instanceof Array&&F.last(a)instanceof s||(a=[a]),c=[];for(f=0,l=a.length;f<l;f++)o=a[f],u=r(o=D(o)),u===e.noMore||o.isEnd()?i!=null?c.push(i()):c.push(setTimeout(function(){return i()},0)):c.push(void 0);return c})})},e.$={asEventStream:function(t,n,r){var i,s=this;return E(n)&&(i=[n,null],r=i[0],n=i[1]),e.fromBinder(function(e){return s.on(t,n,e),function(){return s.off(t,n,e)}},r)}},(I=typeof jQuery!=="undefined"&&jQuery!==null?jQuery:typeof Zepto!=="undefined"&&Zepto!==null?Zepto:null)!=null&&(I.fn.asEventStream=e.$.asEventStream),e.fromEventTarget=function(t,n,r){var i,s,o,u,a,f;return i=(o=t.addEventListener)!=null?o:(u=t.addListener)!=null?u:t.bind,s=(a=t.removeEventListener)!=null?a:(f=t.removeListener)!=null?f:t.unbind,e.fromBinder(function(e){return i.call(t,n,e),function(){return s.call(t,n,e)}},r)},e.fromPromise=function(t){return e.fromBinder(function(e){return t.then(e,function(t){return e(new i(t))}),function(){return typeof t.abort=="function"?t.abort():void 0}},function(e){return[e,m()]})},e.noMore=["<no-more>"],e.more=["<more>"],e.later=function(t,n){return e.sequentially(t,[n])},e.sequentially=function(t,n){var r;return r=0,e.fromPoll(t,function(){var e;return e=n[r++],r<n.length?e:[e,m()]})},e.repeatedly=function(t,n){var r;return r=0,e.fromPoll(t,function(){return n[r++%n.length]})},x=function(t){return function(){var n,r,i;return r=arguments[0],n=2<=arguments.length?q.call(arguments,1):[],i=A(t,[function(e,t){return r.apply(null,q.call(e).concat([t]))}]),e.combineAsArray(n).flatMap(i)}},e.fromCallback=x(function(){var t,n;return n=arguments[0],t=2<=arguments.length?q.call(arguments,1):[],e.fromBinder(function(e){return T(n,t)(e),L},function(e){return[e,m()]})}),e.fromNodeCallback=x(function(){var t,n;return n=arguments[0],t=2<=arguments.length?q.call(arguments,1):[],e.fromBinder(function(e){return T(n,t)(e),L},function(e,t){return e?[new i(e),m()]:[t,m()]})}),e.fromPoll=function(t,n){return e.fromBinder(function(e){var n;return n=setInterval(e,t),function(){return clearInterval(n)}},n)},e.interval=function(t,n){return n==null&&(n={}),e.fromPoll(t,function(){return k(n)})},e.constant=function(e){return new c(M([e],b),!0)},e.never=function(){return e.fromArray([])},e.once=function(t){return e.fromArray([t])},e.fromArray=function(e){return new o(M(e,k))},M=function(e,t){return function(n){var r,i,s;for(i=0,s=e.length;i<s;i++)r=e[i],n(t(r));return n(m()),L}},e.mergeAll=function(e){var t,n,r,i,s;n=F.head(e),s=F.tail(e);for(r=0,i=s.length;r<i;r++)t=s[r],n=n.merge(t);return n},e.zipAsArray=function(){var t,n;return n=arguments[0],t=2<=arguments.length?q.call(arguments,1):[],n instanceof Array||(n=[n].concat(t)),e.zipWith(n,Array)},e.zipWith=function(t,n){return new o(function(r){var i,s,o,u,a,f,l,c,h,p;i=function(){var e,n,r;r=[];for(e=0,n=t.length;e<n;e++)u=t[e],r.push([]);return r}(),l=!1,f=function(){var e,n,r;r=[];for(e=0,n=t.length;e<n;e++)u=t[e],r.push(L);return r}(),a=function(){var e,t;for(e=0,t=f.length;e<t;e++)n=f[e],n();return l=!0},c=function(t){var n;return n=r(t),(n===e.noMore||t.isEnd())&&a(),n},s=function(t){return function(r){var s,o,u;return r.isError()?c(r):r.isInitial()?e.more:(i[t].push(r),!r.isEnd()&&F.all(function(){var e,t,n;n=[];for(e=0,t=i.length;e<t;e++)s=i[e],n.push(s.length);return n}())&&(u=function(){var e,t,n;n=[];for(e=0,t=i.length;e<t;e++)s=i[e],n.push(s.shift().value());return n}(),o=c(r.apply(F.always(n.apply(null,u))))),F.any(function(){var e,t,n;n=[];for(e=0,t=i.length;e<t;e++)s=i[e],n.push(s.length&&s[0].isEnd());return n}())&&(o=c(m())),o||e.more)}};for(o=h=0,p=t.length;h<p;o=++h)u=t[o],f[o]=function(e){if(!l)return u.subscribe(s(e))}(o);return a})},e.combineAsArray=function(){var t,n,r,i,s=this;return r=arguments[0],t=2<=arguments.length?q.call(arguments,1):[],r instanceof Array||(r=[r].concat(t)),r.length?(i=function(){var e,t,i;i=[];for(e=0,t=r.length;e<t;e++)n=r[e],i.push(f);return i}(),new c(function(t){var s,o,u,a,f,c,h,d,v,g,y,b;g=!1,v=function(){var e,t,i;i=[];for(e=0,t=r.length;e<t;e++)n=r[e],i.push(L);return i}(),d=function(){var e,t,n;for(t=0,n=v.length;t<n;t++)e=v[t],e();return g=!0},u=function(){var e,t,i;i=[];for(e=0,t=r.length;e<t;e++)n=r[e],i.push(!1);return i}(),s=function(){var n;if(F.all(u))return n=t(m()),n===e.noMore&&d(),n},f=!1,o=function(n,r){return function(o){var u,a;return o.isEnd()?(n(),s(),e.noMore):o.isError()?(u=t(o),u===e.noMore&&d(),u):(r(o.value),F.all(F.map(function(e){return e.isDefined},i))?f&&o.isInitial()?e.more:(f=!0,a=function(){var e,t,n,r;r=[];for(t=0,n=i.length;t<n;t++)e=i[t],r.push(e.get()());return r},u=t(o.apply(a)),u===e.noMore&&d(),u):e.more)}},c=function(e){return o(function(){return u[e]=!0},function(t){return i[e]=new p(t)})};for(a=y=0,b=r.length;y<b;a=++y)h=r[a],h instanceof l||(h=e.constant(h)),g||(v[a]=h.subscribe(c(a)));return d})):e.constant([])},e.onValues=function(){var t,n,r;return n=2<=arguments.length?q.call(arguments,0,r=arguments.length-1):(r=0,[]),t=arguments[r++],e.combineAsArray(n).onValues(t)},e.combineWith=function(){var t,n;return t=arguments[0],n=2<=arguments.length?q.call(arguments,1):[],e.combineAsArray(n).map(function(e){return t.apply(null,e)})},e.combineTemplate=function(t){var n,r,i,s,o,u,a,f,c,h;return a=[],h=[],u=function(e){return e[e.length-1]},c=function(e,t,n){return u(e)[t]=n},n=function(e,t){return function(n,r){return c(n,e,r[t])}},o=function(e,t){return function(n,r){return c(n,e,t)}},f=function(e){return e instanceof Array?[]:{}},i=function(e,t){var r,i;return t instanceof l?(h.push(t),a.push(n(e,h.length-1))):typeof t=="object"?(i=function(e){return function(n,r){var i;return i=f(t),c(n,e,i),n.push(i)}},r=function(e,t){return e.pop()},a.push(i(e)),s(t),a.push(r)):a.push(o(e,t))},s=function(e){return F.each(e,i)},s(t),r=function(e){var n,r,i,s,o;i=f(t),n=[i];for(s=0,o=a.length;s<o;s++)r=a[s],r(n,e);return i},e.combineAsArray(h).map(r)},s=function(){function e(){}return e.prototype.isEvent=function(){return!0},e.prototype.isEnd=function(){return!1},e.prototype.isInitial=function(){return!1},e.prototype.isNext=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.hasValue=function(){return!1},e.prototype.filter=function(e){return!0},e.prototype.onDone=function(e){return e()},e}(),a=function(e){function t(e,t){var n=this;E(e)?this.value=function(){var t;return t=e(),n.value=F.always(t),t}:this.value=F.always(e)}return U(t,e),t.prototype.isNext=function(){return!0},t.prototype.hasValue=function(){return!0},t.prototype.fmap=function(e){var t=this;return this.apply(function(){return e(t.value())})},t.prototype.apply=function(e){return new t(e)},t.prototype.filter=function(e){return e(this.value())},t.prototype.describe=function(){return this.value()},t}(s),u=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return U(t,e),t.prototype.isInitial=function(){return!0},t.prototype.isNext=function(){return!1},t.prototype.apply=function(e){return new t(e)},t.prototype.toNext=function(){return new a(this.value)},t}(a),r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return U(t,e),t.prototype.isEnd=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.describe=function(){return"<end>"},t}(s),i=function(e){function t(e){this.error=e}return U(t,e),t.prototype.isError=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.describe=function(){return"<error> "+this.error},t}(s),l=function(){function t(){this.combine=z(this.combine,this),this.flatMapLatest=z(this.flatMapLatest,this),this.scan=z(this.scan,this),this.takeUntil=z(this.takeUntil,this),this.assign=this.onValue}return t.prototype.onValue=function(){var e,t;return t=arguments[0],e=2<=arguments.length?q.call(arguments,1):[],t=T(t,e),this.subscribe(function(e){if(e.hasValue())return t(e.value())})},t.prototype.onValues=function(e){return this.onValue(function(t){return e.apply(null,t)})},t.prototype.onError=function(){var e,t;return t=arguments[0],e=2<=arguments.length?q.call(arguments,1):[],t=T(t,e),this.subscribe(function(e){if(e.isError())return t(e.error)})},t.prototype.onEnd=function(){var e,t;return t=arguments[0],e=2<=arguments.length?q.call(arguments,1):[],t=T(t,e),this.subscribe(function(e){if(e.isEnd())return t()})},t.prototype.errors=function(){return this.filter(function(){return!1})},t.prototype.filter=function(){var t,n;return n=arguments[0],t=2<=arguments.length?q.call(arguments,1):[],n instanceof c?n.sampledBy(this,function(e,t){return[e,t]}).filter(function(e){var t,n;return t=e[0],n=e[1],t}).map(function(e){var t,n;return t=e[0],n=e[1],n}):(n=T(n,t),this.withHandler(function(t){return t.filter(n)?this.push(t):e.more}))},t.prototype.takeWhile=function(){var t,n;return n=arguments[0],t=2<=arguments.length?q.call(arguments,1):[],n=T(n,t),this.withHandler(function(t){return t.filter(n)?this.push(t):(this.push(m()),e.noMore)})},t.prototype.endOnError=function(){return this.withHandler(function(e){return e.isError()?(this.push(e),this.push(m())):this.push(e)})},t.prototype.take=function(t){return this.withHandler(function(n){return n.hasValue()?(t--,t>0?this.push(n):(this.push(n),this.push(m()),e.noMore)):this.push(n)})},t.prototype.map=function(){var e,t;return t=arguments[0],e=2<=arguments.length?q.call(arguments,1):[],t=T(t,e),this.withHandler(function(e){return this.push(e.fmap(t))})},t.prototype.mapError=function(){var e,t;return t=arguments[0],e=2<=arguments.length?q.call(arguments,1):[],t=T(t,e),this.withHandler(function(e){return e.isError()?this.push(k(t(e.error))):this.push(e)})},t.prototype.mapEnd=function(){var t,n;return n=arguments[0],t=2<=arguments.length?q.call(arguments,1):[],n=T(n,t),this.withHandler(function(t){return t.isEnd()?(this.push(k(n(t))),this.push(m()),e.noMore):this.push(t)})},t.prototype.doAction=function(){var e,t;return t=arguments[0],e=2<=arguments.length?q.call(arguments,1):[],t=T(t,e),this.withHandler(function(e){return e.hasValue()&&t(e.value()),this.push(e)})},t.prototype.takeUntil=function(t){var n;return n=this,this.withSubscribe(function(r){var i,s,o,u,a,f;return f=!1,u=L,a=L,o=function(){return u(),a(),f=!0},i=function(t){return t.isEnd()?(a(),r(t),e.noMore):(t.onDone(function(){var n;if(!f){n=r(t);if(n===e.noMore)return o()}}),e.more)},s=function(t){return t.isError()?e.more:t.isEnd()?e.noMore:(u(),r(m()),e.noMore)},u=n.subscribe(i),f||(a=t.subscribe(s)),o})},t.prototype.skip=function(t){return this.withHandler(function(n){return n.hasValue()?t>0?(t--,e.more):this.push(n):this.push(n)})},t.prototype.skipDuplicates=function(e){return e==null&&(e=function(e,t){return e===t}),this.withStateMachine(f,function(t,n){return n.hasValue()?t===f||!e(t.get(),n.value())?[new p(n.value()),[n]]:[t,[]]:[t,[n]]})},t.prototype.withStateMachine=function(t,n){var r;return r=t,this.withHandler(function(t){var i,s,o,u,a,f,l;i=n(r,t),s=i[0],u=i[1],r=s,a=e.more;for(f=0,l=u.length;f<l;f++){o=u[f],a=this.push(o);if(a===e.noMore)return a}return a})},t.prototype.scan=function(t,n){var r,i,s=this;return n=_(n),r=B(t),i=function(t){var i,o;return i=!1,o=s.subscribe(function(s){return s.hasValue()?i&&s.isInitial()?e.more:(i=!0,r=new p(n(r.getOrElse(void 0),s.value())),t(s.apply(F.always(r.get())))):(s.isEnd()&&(i=!0),t(s))}),i||r.forEach(function(n){var r;r=t(b(n));if(r===e.noMore)return o(),o=L}),o},new c(i)},t.prototype.zip=function(t,n){return n==null&&(n=Array),e.zipWith([this,t],n)},t.prototype.diff=function(e,t){return t=_(t),this.scan([e],function(e,n){return[n,t(e[0],n)]}).filter(function(e){return e.length===2}).map(function(e){return e[1]})},t.prototype.flatMap=function(n){var r;return n=N(n),r=this,new o(function(i){var s,o,a,f,l,c;return o=[],a=!1,c=function(){},l=function(){var e,t,n;c();for(t=0,n=o.length;t<n;t++)e=o[t],e();return o=[]},s=function(){if(a&&o.length===0)return i(m())},f=function(r){var f,c,h,p,d;if(r.isEnd())return a=!0,s();if(r.isError())return i(r);f=n(r.value()),f instanceof t||(f=e.once(f)),d=void 0,c=!1,p=function(){return d!=null&&O(d,o),s()},h=function(t){var n;return t.isEnd()?(p(),c=!0,e.noMore):(t instanceof u&&(t=t.toNext()),n=i(t),n===e.noMore&&l(),n)},d=f.subscribe(h);if(!c)return o.push(d)},c=r.subscribe(f),l})},t.prototype.flatMapLatest=function(e){var t,n=this;return e=N(e),t=this.toEventStream(),t.flatMap(function(n){return e(n).takeUntil(t)})},t.prototype.not=function(){return this.map(function(e){return!e})},t.prototype.log=function(){var e;return e=1<=arguments.length?q.call(arguments,0):[],this.subscribe(function(t){return typeof console!="undefined"&&console!==null?typeof console.log=="function"?console.log.apply(console,q.call(e).concat([t.describe()])):void 0:void 0}),this},t.prototype.slidingWindow=function(e){return this.scan([],function(t,n){return t.concat([n]).slice(-e)})},t.prototype.combine=function(t,n){var r;return r=_(n),e.combineAsArray(this,t).map(function(e){return r(e[0],e[1])})},t}(),o=function(t){function r(e){var t;r.__super__.constructor.call(this),t=new n(e),this.subscribe=t.subscribe,this.hasSubscribers=t.hasSubscribers}return U(r,t),r.prototype.map=function(){var e,t;return t=arguments[0],e=2<=arguments.length?q.call(arguments,1):[],t instanceof c?t.sampledBy(this,g):r.__super__.map.apply(this,[t].concat(q.call(e)))},r.prototype.delay=function(t){return this.flatMap(function(n){return e.later(t,n)})},r.prototype.debounce=function(t){return this.flatMapLatest(function(n){return e.later(t,n)})},r.prototype.throttle=function(e){return this.bufferWithTime(e).map(function(e){return e[e.length-1]})},r.prototype.bufferWithTime=function(e){var t,n=this;return t=function(e){return e.schedule()},this.buffer(e,t,t)},r.prototype.bufferWithCount=function(e){var t;return t=function(t){if(t.values.length===e)return t.flush()},this.buffer(0,t)},r.prototype.buffer=function(t,n,r){var i,s,o;return n==null&&(n=function(){}),r==null&&(r=function(){}),i={scheduled:!1,end:null,values:[],flush:function(){var t;this.scheduled=!1;if(this.values.length>0){t=this.push(k(this.values)),this.values=[];if(this.end!=null)return this.push(this.end);if(t!==e.noMore)return r(this)}else if(this.end!=null)return this.push(this.end)},schedule:function(){var e=this;if(!this.scheduled)return this.scheduled=!0,t(function(){return e.flush()})}},o=e.more,E(t)||(s=t,t=function(e){return setTimeout(e,s)}),this.withHandler(function(e){return i.push=this.push,e.isError()?o=this.push(e):e.isEnd()?(i.end=e,i.scheduled||i.flush()):(i.values.push(e.value()),n(i)),o})},r.prototype.merge=function(t){var n;return n=this,new r(function(r){var i,s,o,u,a,f;return u=L,a=L,f=!1,o=function(){return u(),a(),f=!0},i=0,s=function(t){var n;return t.isEnd()?(i++,i===2?r(m()):e.more):(n=r(t),n===e.noMore&&o(),n)},u=n.subscribe(s),f||(a=t.subscribe(s)),o})},r.prototype.toProperty=function(e){return arguments.length===0&&(e=f),this.scan(e,S)},r.prototype.toEventStream=function(){return this},r.prototype.concat=function(e){var t;return t=this,new r(function(n){var r;return r=t.subscribe(function(t){return t.isEnd()?r=e.subscribe(n):n(t)}),function(){return r()}})},r.prototype.awaiting=function(e){return this.map(!0).merge(e.map(!1)).toProperty(!1)},r.prototype.startWith=function(t){return e.once(t).concat(this)},r.prototype.withHandler=function(e){var t;return t=new n(this.subscribe,e),new r(t.subscribe)},r.prototype.withSubscribe=function(e){return new r(e)},r}(l),c=function(t){function n(t,r){this.toEventStream=z(this.toEventStream,this),this.toProperty=z(this.toProperty,this),this.changes=z(this.changes,this),this.sample=z(this.sample,this);var i,s=this;n.__super__.constructor.call(this),r===!0?this.subscribe=t:this.subscribe=(new h(t,r)).subscribe,i=function(t,r,i){var o,u;return o=f,u=f,new n(function(n){var a,f,l,c,h,d,v,g,y,b,w;return w=!1,y=L,b=L,g=function(){return y(),b(),w=!0},c=!1,d=!1,a=function(){var t;if(c&&d)return t=n(m()),t===e.noMore&&g(),t},l=!1,f=function(t,r,i){return function(s){var f;return s.isEnd()?(t(),a(),e.noMore):s.isError()?(f=n(s),f===e.noMore&&g(),f):(r(new p(s.value)),o.isDefined&&u.isDefined?l&&s.isInitial()?e.more:(l=!0,f=i(n,s,o.value,u.value),f===e.noMore&&g(),f):e.more)}},h=f(function(){return c=!0},function(e){return o=e},r),v=f(function(){return d=!0},function(e){return u=e},i),y=s.subscribe(h),w||(b=t.subscribe(v)),g})},this.sampledBy=function(e,t){var n,r;return t==null&&(t=g),t=_(t),n=function(e,n,r,i){return e(n.apply(function(){return t(r(),i())}))},r=i(e,L,n),e instanceof o&&(r=r.changes()),r.takeUntil(e.filter(!1).mapEnd())}}return U(n,t),n.prototype.sample=function(t){return this.sampledBy(e.interval(t,{}))},n.prototype.changes=function(){var e=this;return new o(function(t){return e.subscribe(function(e){if(!e.isInitial())return t(e)})})},n.prototype.withHandler=function(e){return new n(this.subscribe,e)},n.prototype.withSubscribe=function(e){return new n(e)},n.prototype.toProperty=function(){return this},n.prototype.toEventStream=function(){var e=this;return new o(function(t){return e.subscribe(function(e){return e.isInitial()&&(e=e.toNext()),t(e)})})},n.prototype.and=function(e){return this.combine(e,function(e,t){return e&&t})},n.prototype.or=function(e){return this.combine(e,function(e,t){return e||t})},n.prototype.decode=function(t){return this.combine(e.combineTemplate(t),function(e,t){return t[e]})},n.prototype.delay=function(e){return this.delayChanges(function(t){return t.delay(e)})},n.prototype.debounce=function(e){return this.delayChanges(function(t){return t.debounce(e)})},n.prototype.throttle=function(e){return this.delayChanges(function(t){return t.throttle(e)})},n.prototype.delayChanges=function(e){return d(this,e(this.changes()))},n}(l),d=function(t,n){var r;return r=function(t){var n;return n=f,t.subscribe(function(t){return t.isInitial()&&(n=new p(t.value())),e.noMore}),n},n.toProperty(r(t))},n=function(){function t(t,n){var r,i,o,u,a,f,l,c,h,p,d=this;t==null&&(t=function(){return L}),c=[],f=null,a=!1,o=!1,this.hasSubscribers=function(){return c.length>0},u=null,h=L,l=function(e){return c=F.without(e,c)},p=null,i=function(e){var t,n,r,i;if(p!=null){n=p,p=null;for(r=0,i=n.length;r<i;r++)t=n[r],t()}return e.onDone=s.prototype.onDone},r=function(e){return p=(p||[]).concat([e])},this.push=function(t){var n,s,o,h,p,v;if(!a){if(t===u)return;t.isError()&&(u=t),o=!1;try{a=!0,t.onDone=r,h=c;for(p=0,v=h.length;p<v;p++)s=h[p],n=s.sink(t),(n===e.noMore||t.isEnd())&&l(s);o=!0}finally{a=!1,o||(f=null)}o=!0;while(f!=null?f.length:void 0)t=F.head(f),f=F.tail(f),d.push(t);return i(t),d.hasSubscribers()?e.more:e.noMore}return f=(f||[]).concat([t]),e.more},n==null&&(n=function(e){return this.push(e)}),this.handleEvent=function(e){return e.isEnd()&&(o=!0),n.apply(d,[e])},this.subscribe=function(e){var n;return o?(e(m()),L):(n={sink:e},c=c.concat(n),c.length===1&&(h=t(d.handleEvent)),function(){l(n);if(!d.hasSubscribers())return h()})}}return t}(),h=function(t){function n(t,r){var i,s,o,u=this;n.__super__.constructor.call(this,t,r),i=f,o=this.push,t=this.subscribe,s=!1,this.push=function(e){return e.isEnd()&&(s=!0),e.hasValue()&&(i=new p(e.value())),o.apply(u,[e])},this.subscribe=function(n){var r,o,a;return r=!1,a=function(){return u.hasSubscribers()||s},o=i.filter(a).map(function(e){return n(b(e))}),o.getOrElse(e.more)===e.noMore?L:s?(n(m()),L):t.apply(u,[n])}}return U(n,t),n}(n),t=function(t){function n(){var t,r,s,o,u,a,f,l,c=this;s=void 0,a=[],t=!1,r=function(t){return function(n){return n.isEnd()?(l(t),e.noMore):s(n)}},f=function(){var e,t,n,r;r=[];for(t=0,n=a.length;t<n;t++)e=a[t],r.push(typeof e.unsub=="function"?e.unsub():void 0);return r},u=function(e){return e.unsub=e.input.subscribe(r(e.input))},l=function(e){var t,n,r,i;for(t=r=0,i=a.length;r<i;t=++r){n=a[t];if(n.input===e){typeof n.unsub=="function"&&n.unsub(),a.splice(t,1);return}}},o=function(e){var t,n,r,i,o;s=e,n=[],o=v(a);for(r=0,i=o.length;r<i;r++)t=o[r],u(t);return f},n.__super__.constructor.call(this,o),this.plug=function(e){var n;if(t)return;return n={input:e},a.push(n),s!=null&&u(n),function(){return l(e)}},this.push=function(e){return typeof s=="function"?s(k(e)):void 0},this.error=function(e){return typeof s=="function"?s(new i(e)):void 0},this.end=function(){return t=!0,f(),typeof s=="function"?s(m()):void 0}}return U(n,t),n}(o),p=function(){function e(e){this.value=e}return e.prototype.getOrElse=function(){return this.value},e.prototype.get=function(){return this.value},e.prototype.filter=function(t){return t(this.value)?new e(this.value):f},e.prototype.map=function(t){return new e(t(this.value))},e.prototype.forEach=function(e){return e(this.value)},e.prototype.isDefined=!0,e.prototype.toArray=function(){return[this.value]},e}(),f={getOrElse:function(e){return e},filter:function(){return f},map:function(){return f},forEach:function(){},isDefined:!1,toArray:function(){return[]}},e.EventStream=o,e.Property=c,e.Observable=l,e.Bus=t,e.Initial=u,e.Next=a,e.End=r,e.Error=i,L=function(){},S=function(e,t){return t},g=function(e,t){return e},b=function(e){return new u(F.always(e))},k=function(e){return new a(F.always(e))},m=function(){return new r},D=function(e){return e instanceof s?e:k(e)},v=function(e){return e.slice(0)},y=Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){var n,r,i,s;for(n=i=0,s=e.length;i<s;n=++i){r=e[n];if(t===r)return n}return-1},O=function(e,t){var n;n=y(t,e);if(n>=0)return t.splice(n,1)},E=function(e){return typeof e=="function"},C=function(e,t,n){return n===void 0&&(n=[]),function(r){return e[t].apply(e,n.concat([r]))}},A=function(e,t){return function(){var n;return n=1<=arguments.length?q.call(arguments,0):[],e.apply(null,t.concat(n))}},N=function(e){return e instanceof l&&(e=F.always(e)),e},T=function(e,t){return E(e)?t.length?A(e,t):e:w(e)?P(e,t):typeof e=="object"&&t.length?C(e,F.head(t),F.tail(t)):F.always(e)},w=function(e){return typeof e=="string"&&e.length>1&&e.charAt(0)==="."},e.isFieldKey=w,P=function(e,t){var n,r;return r=e.slice(1).split("."),n=F.map(j(t),r),function(t){var r,i;for(r=0,i=n.length;r<i;r++)e=n[r],t=e(t);return t}},j=function(e){return function(t){return function(n){var r;return n==null?void 0:(r=n[t],E(r)?r.apply(n,e):r)}}},H=function(e){return e.slice(1)},_=function(e){var t;if(E(e))return e;if(w(e))return t=H(e),function(e,n){return e[t](n)}},B=function(e){return e instanceof p||e===f?e:new p(e)},typeof define!="undefined"&&define!==null&&define.amd!=null&&typeof define=="function"&&define(function(){return e}),F={head:function(e){return e[0]},always:function(e){return function(){return e}},empty:function(e){return e.length===0},tail:function(e){return e.slice(1,e.length)},filter:function(e,t){var n,r,i,s;n=[];for(i=0,s=t.length;i<s;i++)r=t[i],e(r)&&n.push(r);return n},map:function(e,t){var n,r,i,s;s=[];for(r=0,i=t.length;r<i;r++)n=t[r],s.push(e(n));return s},each:function(e,t){var n,r,i;i=[];for(n in e)r=e[n],i.push(t(n,r));return i},toArray:function(e){return e instanceof Array?e:[e]},contains:function(e,t){return y(e,t)!==-1},id:function(e){return e},last:function(e){return e[e.length-1]},all:function(e){var t,n,r;for(n=0,r=e.length;n<r;n++){t=e[n];if(!t)return!1}return!0},any:function(e){var t,n,r;for(n=0,r=e.length;n<r;n++){t=e[n];if(t)return!0}return!1},without:function(e,t){return F.filter(function(t){return t!==e},t)}},e._=F}).call(this);