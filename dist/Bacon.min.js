(function(){function a(a,b){function c(){}return c.prototype=(a.superclass=b).prototype,(a.prototype=new c).constructor=a,"function"==typeof b.extended&&b.extended(a),a}function b(a,b){var c={}.hasOwnProperty;for(var d in b)c.call(b,d)&&(a[d]=b[d]);return a}function c(a,b,c){return function(){return(c||a)[b].apply(a,arguments)}}var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X=[].slice;d={},d.version="<version>",d.fromBinder=function(a,b){return null==b&&(b=W.id),new o(function(c){var e;return e=a(function(){function a(){return e()}var f,g,i,j,k,l;for(f=X.call(arguments),g=b.apply(null,f),g instanceof Array&&W.last(g)instanceof h||(g=[g]),i=d.more,j=0,k=g.length;k>j;++j)if(l=g[j],i=c(l=H(l)),i===d.noMore||l.isEnd())return null!=e?e():d.scheduler.setTimeout(a,0),i;return i})})},d.$={asEventStream:function(a,b,c){var e,f=this;return K(b)&&(e=[b,null],c=e[0],b=e[1]),d.fromBinder(function(c){return f.on(a,b,c),function(){return f.off(a,b,c)}},c)}},null!=(e="undefined"!=typeof jQuery&&null!==jQuery?jQuery:"undefined"!=typeof Zepto&&null!==Zepto?Zepto:null)&&(e.fn.asEventStream=d.$.asEventStream),d.fromEventTarget=function(a,b,c){var e,f,g;return e=null!=(f=a.addEventListener)?f:null!=(f=a.addListener)?f:a.bind,g=null!=(f=a.removeEventListener)?f:null!=(f=a.removeListener)?f:a.unbind,d.fromBinder(function(c){return e.call(a,b,c),function(){return g.call(a,b,c)}},c)},d.fromPromise=function(a,b){return d.fromBinder(function(c){return a.then(c,function(a){return c(new l(a))}),function(){return b?"function"==typeof a.abort?a.abort():void 0:void 0}},function(a){return[a,G()]})},d.noMore=["<no-more>"],d.more=["<more>"],d.later=function(a,b){return d.sequentially(a,[b])},d.sequentially=function(a,b){var c;return c=0,d.fromPoll(a,function(){var a;return a=b[c++],c<b.length?a:c===b.length?[a,G()]:G()})},d.repeatedly=function(a,b){var c;return c=0,d.fromPoll(a,function(){return b[c++%b.length]})},f=function(a){return function(b){var c,d,e;return c=X.call(arguments,1),"object"==typeof b&&c.length&&(d=b,e=c[0],b=function(){return d[e].apply(d,arguments)},c=c.slice(1)),a.apply(null,[b].concat(X.call(c)))}},g=function(a){return f(function(b){var c,e;return c=X.call(arguments,1),e=L(a,[function(a,c){return b.apply(null,X.call(a).concat([c]))}]),d.combineAsArray(c).flatMap(e)})},d.fromCallback=g(function(a){var b;return b=X.call(arguments,1),d.fromBinder(function(c){return P(a,b)(c),B},function(a){return[a,G()]})}),d.fromNodeCallback=g(function(a){var b;return b=X.call(arguments,1),d.fromBinder(function(c){return P(a,b)(c),B},function(a,b){return a?[new l(a),G()]:[b,G()]})}),d.fromPoll=function(a,b){return d.fromBinder(function(b){var c;return c=d.scheduler.setInterval(b,a),function(){return d.scheduler.clearInterval(c)}},b)},d.interval=function(a,b){return null==b&&(b={}),d.fromPoll(a,function(){return F(b)})},d.constant=function(a){return new p(function(b){return b(E(a)),b(G()),B})},d.never=function(){return d.fromArray([])},d.once=function(a){return d.fromArray([a])},d.fromArray=function(a){return a=I(a),new o(function(b){var c,e;return c=!1,e=function(){var f,g;return W.empty(a)?b(G()):(f=a.splice(0,1)[0],g=b(H(f)),g===d.noMore||c?void 0:e())},e(),function(){var a;return a=!0}})},d.mergeAll=function(){var a;return a=X.call(arguments),a[0]instanceof Array&&(a=a[0]),W.fold(a,d.never(),function(a,b){return a.merge(b)})},d.zipAsArray=function(){var a;return a=X.call(arguments),a[0]instanceof Array&&(a=a[0]),d.zipWith(a,function(){var a;return a=X.call(arguments)})},d.zipWith=function(a){var b,c;return b=X.call(arguments,1),K(a)||(c=[a,b[0]],b=c[0],a=c[1]),d.when(W.map(function(a){return a.toEventStream()},b),a)},d.combineAsArray=function(){var a,b,c,e,f,g,h,i;for(a=X.call(arguments),1===a.length&&a[0]instanceof Array&&(a=a[0]),b=0,c=a.length;c>b;++b)e=b,f=a[b],f instanceof m||(a[e]=d.constant(f));if(a.length){for(h=[],b=0,c=a.length;c>b;++b)i=a[b],h.push(new w(i,!0,!1,i.subscribeInternal));return g=h,d.when(g,function(){var a;return a=X.call(arguments)}).toProperty()}return d.constant([])},d.onValues=function(){var a,b,c;return b=0<(a=arguments.length-1)?X.call(arguments,0,a):(a=0,[]),c=arguments[a],d.combineAsArray(b).onValues(c)},d.combineWith=function(a){var b;return b=X.call(arguments,1),d.combineAsArray(b).map(function(b){return a.apply(null,b)})},d.combineTemplate=function(a){var b,c,e,f,g,h,i,j,k,l;return b=[],c=[],e=function(a){return a[a.length-1]},f=function(a,b,c){return e(a)[b]=c},g=function(a,b){return function(c,d){return f(c,a,d[b])}},h=function(a,b){return function(c){return f(c,a,b)}},i=function(a){return a instanceof Array?[]:{}},j=function(a,d){var e,j;return d instanceof m?(c.push(d),b.push(g(a,c.length-1))):d===Object(d)&&"function"!=typeof d?(e=function(a){return function(b){var c;return c=i(d),f(b,a,c),b.push(c)}},j=function(a){return a.pop()},b.push(e(a)),k(d),b.push(j)):b.push(h(a,d))},k=function(a){return W.each(a,j)},k(a),l=function(c){var d,e,f,g,h,j;for(d=i(a),e=[d],f=0,h=(g=b).length;h>f;++f)j=g[f],j(e,c);return d},d.combineAsArray(c).map(l)},h=function(){function a(){}a.displayName="Event";var b=a.prototype;return b.isEvent=function(){return!0},b.isEnd=function(){return!1},b.isInitial=function(){return!1},b.isNext=function(){return!1},b.isError=function(){return!1},b.hasValue=function(){return!1},b.filter=function(){return!0},a}(),i=function(c){function d(a){this.value=K(a)?W.cached(a):W.always(a)}var e=a((b(d,c).displayName="Next",d),c).prototype;return e.isNext=function(){return!0},e.hasValue=function(){return!0},e.fmap=function(a){var b=this;return this.apply(function(){return a(b.value())})},e.apply=function(a){return new d(a)},e.filter=function(a){return a(this.value())},e.describe=function(){return this.value()},d}(h),j=function(c){function d(){d.superclass.apply(this,arguments)}var e=a((b(d,c).displayName="Initial",d),c).prototype;return e.isInitial=function(){return!0},e.isNext=function(){return!1},e.apply=function(a){return new d(a)},e.toNext=function(){return new i(this.value)},d}(i),k=function(c){function d(){d.superclass.apply(this,arguments)}var e=a((b(d,c).displayName="End",d),c).prototype;return e.isEnd=function(){return!0},e.fmap=function(){return this},e.apply=function(){return this},e.describe=function(){return"<end>"},d}(h),l=function(c){function d(a){this.error=a}var e=a((b(d,c).displayName="Error",d),c).prototype;return e.isError=function(){return!0},e.fmap=function(){return this},e.apply=function(){return this},e.describe=function(){return"<error> "+this.error},d}(h),m=function(){function a(){this.combine=c(this,"combine",b),this.flatMapLatest=c(this,"flatMapLatest",b),this.fold=c(this,"fold",b),this.scan=c(this,"scan",b),this.assign=this.onValue}a.displayName="Observable";var b=a.prototype;return b.onValue=function(){var a;return a=N(arguments),this.subscribe(function(b){return b.hasValue()?a(b.value()):void 0})},b.onValues=function(a){return this.onValue(function(b){return a.apply(null,b)})},b.onError=function(){var a;return a=N(arguments),this.subscribe(function(b){return b.isError()?a(b.error):void 0})},b.onEnd=function(){var a;return a=N(arguments),this.subscribe(function(b){return b.isEnd()?a():void 0})},b.errors=function(){return this.filter(function(){return!1})},b.filter=function(a){var b;return b=X.call(arguments,1),q(this,a,b,function(a){return this.withHandler(function(b){return b.filter(a)?this.push(b):d.more})})},b.takeWhile=function(a){var b;return b=X.call(arguments,1),q(this,a,b,function(a){return this.withHandler(function(b){return b.filter(a)?this.push(b):(this.push(G()),d.noMore)})})},b.endOnError=function(a){var b;return b=X.call(arguments,1),null==a&&(a=!0),q(this,a,b,function(a){return this.withHandler(function(b){return b.isError()&&a(b.error)?(this.push(b),this.push(G())):this.push(b)})})},b.take=function(a){return 0>=a?d.never():this.withHandler(function(b){return b.hasValue()?(a--,a>0?this.push(b):(0===a&&this.push(b),this.push(G()),d.noMore)):this.push(b)})},b.map=function(a){var b;return b=X.call(arguments,1),a instanceof p?a.sampledBy(this,D):q(this,a,b,function(a){return this.withHandler(function(b){return this.push(b.fmap(a))})})},b.mapError=function(){var a;return a=N(arguments),this.withHandler(function(b){return b.isError()?this.push(F(a(b.error))):this.push(b)})},b.mapEnd=function(){var a;return a=N(arguments),this.withHandler(function(b){return b.isEnd()?(this.push(F(a(b))),this.push(G()),d.noMore):this.push(b)})},b.doAction=function(){var a;return a=N(arguments),this.withHandler(function(b){return b.hasValue()&&a(b.value()),this.push(b)})},b.skip=function(a){return this.withHandler(function(b){return b.hasValue()?a>0?(a--,d.more):this.push(b):this.push(b)})},b.skipDuplicates=function(a){return null==a&&(a=function(a,b){return a===b}),this.withStateMachine(A,function(b,c){return c.hasValue()?c.isInitial()||b===A||!a(b.get(),c.value())?[new z(c.value()),[c]]:[b,[]]:[b,[c]]})},b.skipErrors=function(){return this.withHandler(function(a){return a.isError()?d.more:this.push(a)})},b.withStateMachine=function(a,b){var c;return c=a,this.withHandler(function(a){var c,e,f,g,h,i,j,k;for(c=b(g,a),e=c[0],f=c[1],g=e,h=d.more,i=0,j=f.length;j>i;++i)if(k=f[i],h=this.push(k),h===d.noMore)return h;return h})},b.scan=function(a,b,c){var e,f,g,h=this;return e=U(b),b=c?e:function(a,b){return e(a(),b())},f=V(a).map(function(a){return W.always(a)}),g=function(a){var c,e,g,i;return c=!1,e=B,g=d.more,i=function(){var b;return b?void 0:(b=!0,f.forEach(function(b){var c,e;return c=a(new j(b)),c===d.noMore?(e(),e=B):void 0}))},e=h.subscribe(function(c){var e,f,g,h,j;return c.hasValue()?e&&c.isInitial()?d.more:(c.isInitial()||i(),e=!0,f=h.getOrElse(function(){return void 0}),g=W.cached(function(){return b(f,c.value)}),h=new z(g),a(c.apply(g))):(c.isEnd()&&(j=i()),j!==d.noMore?a(c):void 0)}),i(),e},new p(g)},b.fold=function(a,b){return this.scan(a,b).sampledBy(this.filter(!1).mapEnd().toProperty())},b.zip=function(a,b){return null==b&&(b=Array),d.zipWith([this,a],b)},b.diff=function(a,b){return b=U(b),this.scan([a],function(a,c){return[c,b(a[0],c)]}).filter(function(a){return 2===a.length}).map(function(a){return a[1]})},b.flatMap=function(b,c){var e;return b=M(b),e=this,new o(function(f){var g,h;return g=new y,h=function(a){return a(),g.empty()?f(G()):void 0},g.add(function(i,k){return e.subscribe(function(e){var i;return e.isEnd()?h(k):e.isError()?f(e):c&&g.count()>1?d.more:g.unsubscribed?d.noMore:(i=b(e.value()),i instanceof a||(i=d.once(i)),g.add(function(a,b){return i.subscribe(function(c){var e;return c.isEnd()?(h(b),d.noMore):(c instanceof j&&(c=c.toNext()),e=f(c),e===d.noMore&&a(),e)})}))})}),g.unsubscribe})},b.flatMapFirst=function(a){return this.flatMap(a,!0)},b.flatMapLatest=function(a){var b;return a=M(a),b=this.toEventStream(),b.flatMap(function(c){return a(c).takeUntil(b)})},b.not=function(){return this.map(function(a){return!a})},b.log=function(){var a;return a=X.call(arguments),this.subscribe(function(b){return"undefined"!=typeof console&&null!==console?"function"==typeof console.log?console.log.apply(null,X.call(a).concat([b.describe()])):void 0:void 0}),this},b.slidingWindow=function(a,b){return null==b&&(b=0),this.scan([],function(b,c){return b.concat([c]).slice(-a)}).filter(function(a){return a.length>=b})},b.combine=function(a,b){var c;return c=U(b),d.combineAsArray(this,a).map(function(a){return c(a[0],a[1])})},b.decode=function(a){return this.combine(d.combineTemplate(a),function(a,b){return b[a]})},b.awaiting=function(a){return this.toEventStream().map(!0).merge(a.toEventStream().map(!1)).toProperty(!1)},a}(),m(prototype(n=m(prototype(fold)))),o=function(e){function f(a){var b;this.takeUntil=c(this,"takeUntil",g),this.sampledBy=c(this,"sampledBy",g),f.superclass.call(this),b=new s(a),this.subscribe=b.subscribe,this.subscribeInternal=this.subscribe,this.hasSubscribers=b.hasSubscribers}var g=a((b(f,e).displayName="EventStream",f),e).prototype;return g.delay=function(a){return this.flatMap(function(b){return d.later(a,b)})},g.debounce=function(a){return this.flatMapLatest(function(b){return d.later(a,b)})},g.debounceImmediate=function(a){return this.flatMapFirst(function(b){return d.once(b).concat(d.later(a).filter(!1))})},g.throttle=function(a){return this.bufferWithTime(a).map(function(a){return a[a.length-1]})},g.bufferWithTime=function(a){return this.bufferWithTimeOrCount(a,Number.MAX_VALUE)},g.bufferWithCount=function(a){return this.bufferWithTimeOrCount(void 0,a)},g.bufferWithTimeOrCount=function(a,b){var c;return c=function(c){return c.values.length===b?c.flush():void 0!==a?c.schedule():void 0},this.buffer(a,c,c)},g.buffer=function(a,b,c){var e,f,g;return null==b&&(b=function(){}),null==c&&(c=function(){}),e={scheduled:!1,end:null,values:[],flush:function(){var a;if(this.scheduled=!1,this.values.length>0){if(a=this.push(F(this.values)),this.values=[],null!=this.end)return this.push(this.end);if(a!==d.noMore)return c(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){var b=this;return this.scheduled?void 0:(this.scheduled=!0,a(function(){return b.flush()}))}},f=d.more,K(a)||(g=a,a=function(a){return d.scheduler.setTimeout(a,g)}),this.withHandler(function(a){var c;return e.push=this.push,a.isError()?c=this.push(a):a.isEnd()?(e.end=a,e.scheduled||e.flush()):(e.values.push(a.value()),b(e)),c})},g.merge=function(a){var b;return b=this,new f(function(c){var e,f;return e=0,f=function(a){return function(b){return a.subscribe(function(a){var f;return a.isEnd()?(e++,2===e?c(G()):d.more):(f=c(a),f===d.noMore&&b(),f)})}},x(f(b),f(a))})},g.toProperty=function(a){return 0===arguments.length&&(a=A),this.scan(a,C,!0)},g.toEventStream=function(){return this},g.sampledBy=function(a,b){return this.toProperty().sampledBy(a,b)},g.concat=function(a){var b;return b=this,new f(function(c){var d,e;return d=B,e=b.subscribe(function(b){var d;return b.isEnd()?d=a.subscribe(c):c(b)}),function(){return e(),d()}})},g.takeUntil=function(a){var b;return b=this,new f(function(c){var e,f;return e=function(b){return a.onValue(function(){return c(G()),b(),d.noMore})},f=function(a){return b.subscribe(function(b){var e;return e=c(b),(b.isEnd()||e===d.noMore)&&a(),e})},x(e,f)})},g.skipUntil=function(a){var b;return b=a.take(1).map(!0).toProperty(!1),this.filter(b)},g.skipWhile=function(a){var b,c;return b=X.call(arguments,1),c=!1,q(this,a,b,function(a){return this.withHandler(function(b){var c;return!c&&b.hasValue()&&a(b.value())?d.more:(b.hasValue()&&(c=!0),this.push(b))})})},g.startWith=function(a){return d.once(a).concat(this)},g.withHandler=function(a){var b;return b=new s(this.subscribe,a),new f(b.subscribe)},g.withSubscribe=function(a){return new f(a)},f}(m),p=function(e){function f(a,b){var e=this;this.toEventStream=c(this,"toEventStream",g),this.toProperty=c(this,"toProperty",g),this.changes=c(this,"changes",g),this.sample=c(this,"sample",g),f.superclass.call(this),this.subscribeInternal=b===!0?a:new t(a,b).subscribe,this.sampledBy=function(a,b){var c,g,h,i;return null!=b?b=U(b):(c=!0,b=function(a){return a()}),g=new w(e,!1,!1,e.subscribeInternal,c),h=new w(a,!0,!1,a.subscribe,c),i=d.when([g,h],b),a instanceof f?i.toProperty():i},this.subscribe=function(a){var b,c,f,g,h;return b=d.more,c=function(){function b(){}b.displayName="LatestEvent";var c=b.prototype;return c.set=function(a){return this.event=a},c.send=function(){var b,c;return b=this.event,this.event=null,null!=b&&c!==d.noMore&&(c=a(b),c===d.noMore)?h():void 0},b}(),f=new c,g=new c,h=B,h=e.subscribeInternal(function(b){var c;return b.isError()?c!==d.noMore&&(c=a(b)):(b.hasValue()?f.set(b):b.isEnd()&&g.set(b),u.onDone(function(){return f.send(),g.send()})),c}),function(){var a;return a=d.noMore,h()}}}var g=a((b(f,e).displayName="Property",f),e).prototype;return g.sample=function(a){return this.sampledBy(d.interval(a,{}))},g.changes=function(){var a=this;return new o(function(b){return a.subscribe(function(a){return a.isInitial()?void 0:b(a)})})},g.withHandler=function(a){return new f(this.subscribeInternal,a)},g.withSubscribe=function(a){return new f(a)},g.toProperty=function(){return this},g.toEventStream=function(){var a=this;return new o(function(b){return a.subscribe(function(a){return a.isInitial()&&(a=a.toNext()),b(a)})})},g.and=function(a){return this.combine(a,function(a,b){return a&&b})},g.or=function(a){return this.combine(a,function(a,b){return a||b})},g.delay=function(a){return this.delayChanges(function(b){return b.delay(a)})},g.debounce=function(a){return this.delayChanges(function(b){return b.debounce(a)})},g.throttle=function(a){return this.delayChanges(function(b){return b.throttle(a)})},g.delayChanges=function(a){return r(this,a(this.changes()))},g.takeUntil=function(a){var b;return b=this.changes().takeUntil(a),r(this,b)},g.startWith=function(a){return this.scan(a,function(a,b){return b})},f}(m),q=function(a,b,c,d){var e;return b instanceof p?(e=b.sampledBy(a,function(a,b){return[a,b]}),d.apply(e,[function(a){var b,c;return b=a[0],c=a[1],b}]).map(function(a){var b,c;return b=a[0],c=a[1]})):(b=P(b,c),d.apply(a,[b]))},r=function(a,b){var c;return c=function(a){var b;return b=A,a.subscribe(function(a){var b;return a.hasValue()&&(b=new z(a.value())),d.noMore}),b},b.toProperty(c(a))},s=function(){function a(a,b){var c,e,f,g,h,i,j,k,l,m=this;null==a&&(a=function(){return B}),c=[],e=null,f=!1,g=!1,this.hasSubscribers=function(){return c.length>0},h=null,i=B,j=function(a){var b;return b=W.without(a,b)},k=null,l=function(){var a,b,c,d,e,f=[];if(null!=b){for(a=b,b=null,c=0,d=a.length;d>c;++c)e=a[c],f.push(e());return f}},this.push=function(a){var b,e,f,g,h,i,k,n,o;if(f)return o=(o||[]).concat([a]),d.more;if(a!==b){a.isError()&&(b=a),e=!1;try{for(f=!0,g=c,h=0,i=g.length;i>h;++h)k=g[h],n=k.sink(a),(n===d.noMore||a.isEnd())&&j(k);e=!0}finally{f=!1,e||(o=null)}for(e=!0;null!=o&&o.length;)a=W.head(o),o=W.tail(o),m.push(a);return l(a),m.hasSubscribers()?d.more:d.noMore}},null==b&&(b=function(a){return this.push(a)}),this.handleEvent=function(a){var c;return a.isEnd()&&(c=!0),b.apply(m,[a])},this.subscribe=function(b){var c,d,e;return g?(b(G()),B):(c={sink:b},d=d.concat(c),1===d.length&&(e=a(m.handleEvent)),function(){return j(c),m.hasSubscribers()?void 0:e()})}}a.displayName="Dispatcher";a.prototype;return a}(),t=function(c){function e(a,b){var c,f,g,h=this;e.superclass.call(this,a,b),c=A,f=this.push,a=this.subscribe,g=!1,this.push=function(a){var b,c;return a.isEnd()&&(b=!0),a.hasValue()&&(c=new z(a.value)),u.inTransaction(function(){return f.apply(h,[a])})},this.subscribe=function(b){var e,f,i;return e=!1,f=function(){return h.hasSubscribers()||g},i=c.filter(f).map(function(a){return b(E(a()))}),i.getOrElse(d.more)===d.noMore?B:g?(b(G()),B):a.apply(h,[b])}}a((b(e,c).displayName="PropertyDispatcher",e),c).prototype;return e}(s),u=function(){var a,b,c,d;return a=[],b=!1,c=function(c){return b?a.push(c):c()},d=function(a){var b,c,d,e,f,g,h;if(b)return a();b=!0;try{c=a()}finally{b=!1}for(d=e,e=[],f=0,g=d.length;g>f;++f)h=d[f],h();return c},{onDone:c,inTransaction:d}}(),v=function(c){function e(){var a,b,c,f,g,h,i,j;a=void 0,b=[],c=!1,f=function(b){return function(c){return c.isEnd()?(i(b),d.noMore):a(c)}},g=function(){var a,c,d,e,f=[];for(a=0,d=(c=b).length;d>a;++a)e=c[a],f.push("function"==typeof e.unsub?e.unsub():void 0);return f},h=function(a){return a.unsub=a.input.subscribe(f(a.input))},i=function(a){var c,d,e,f,g;for(c=0,e=(d=b).length;e>c;++c)if(f=c,g=d[c],g.input===a)return"function"==typeof g.unsub&&g.unsub(),b.splice(f,1),void 0},j=function(a){var c,d,e,f,i;for(c=a,d=0,f=(e=I(b)).length;f>d;++d)i=e[d],h(i);return g},e.superclass.call(this,j),this.plug=function(d){var e;if(!c)return e={input:d},b.push(e),null!=a&&h(e),function(){return i(d)}},this.push=function(b){return"function"==typeof a?a(F(b)):void 0},this.error=function(b){return"function"==typeof a?a(new l(b)):void 0},this.end=function(){var b;return b=!0,g(),"function"==typeof a?a(G()):void 0}}a((b(e,c).displayName="Bus",e),c).prototype;return e}(o),w=function(){function a(a,b,c,d,e){var f,g;this.sync=b,this.subscribe=d,null==e&&(e=!1),f=[],g=e?W.id:function(a){return a()},null==this.subscribe&&(this.subscribe=a.subscribe),this.markEnded=function(){return this.ended=!0},c?(this.consume=function(){return g(f.shift())},this.push=function(a){return f.push(a)},this.mayHave=function(a){return!this.ended||f.length>=a},this.hasAtLeast=function(a){return f.length>=a}):(this.consume=function(){return g(f[0])},this.push=function(a){var b;return b=[a]},this.mayHave=function(){return!0},this.hasAtLeast=function(){return f.length})}a.displayName="Source";a.prototype;return a}(),w.fromObservable=function(a){return a instanceof w?a:a instanceof p?new w(a,!1,!1):new w(a,!0,!0)},d.when=function(){function a(){return j}var b,c,e,f,g,h,i,j,k,l,m,n,p,q,r,s,t;if(b=X.call(arguments),0===b.length)return d.never();for(c=b.length,e="when: expecting arguments in the form (Observable+,function)+",f=[],g=[],h=0;c>h;){for(i=W.toArray(b[h]),j=b[h+1],k={f:K(j)?j:a,ixs:[]},l=0,m=i.length;m>l;++l){for(n=i[l],p=J(f,n),0>p&&(f.push(n),p=f.length-1),q=0,s=(r=k.ixs).length;s>q;++q)t=r[q],t.index===p&&t.count++;k.ixs.push({index:p,count:1})}i.length>0&&g.push(k),h+=2}return f.length?(f=W.map(w.fromObservable,f),new o(function(a){var b,c,e,h,i,j;return b=function(a){return W.all(a.ixs,function(a){return f[a.index].hasAtLeast(a.count)})},c=function(a){return!a.sync||a.ended},e=function(a){return W.any(a.ixs,function(a){return!f[a.index].mayHave(a.count)})},h=function(h){return function(i){return h.subscribe(function(j){function k(){var a;return p.f.apply(p,function(){var b,c,d,e=[];for(b=0,d=(c=p.ixs).length;d>b;++b)a=c[b],e.push(f[a.index].consume());return e}())}var l,m,n,o,p,q;if(j.isEnd())h.markEnded(),(W.all(f,c)||W.all(g,e))&&(l=d.noMore,a(G()));else if(j.isError())l=a(j);else if(h.push(j.value),h.sync)for(m=0,o=(n=g).length;o>m;++m)if(p=n[m],b(p)){q=k,l=a(j.apply(q));break}return l===d.noMore&&i(),l||d.more})}},x.apply(null,function(){var a,b,c,d=[];for(a=0,c=(b=f).length;c>a;++a)i=a,j=b[a],d.push(h(j,i));return d}())})):d.never()},d.update=function(a){function b(a){return null==a&&(a=c[f]),function(){return a}}var c,e,f;for(c=X.call(arguments,1),e=function(a){return function(){var b;return b=X.call(arguments),function(c){return a.apply(null,[c].concat(b))}}},f=c.length-1;f>0;)c[f]instanceof Function||(c[f]=b()),c[f]=e(c[f]),f-=2;return d.when.apply(d,c).scan(a,function(a,b){return b(a)})},x=function(){var a;return a=X.call(arguments),new y(a).unsubscribe},y=function(){function a(a){var d,e,f;for(null==a&&(a=[]),this.empty=c(this,"empty",b),this.count=c(this,"count",b),this.unsubscribe=c(this,"unsubscribe",b),this.add=c(this,"add",b),this.unsubscribed=!1,this.subscriptions=[],this.starting=[],d=0,e=a.length;e>d;++d)f=a[d],this.add(f)}a.displayName="CompositeUnsubscribe";var b=a.prototype;return b.add=function(a){var b,c,d,e=this;if(!this.unsubscribed)return b=!1,c=B,this.starting.push(a),d=function(){var b;if(!e.unsubscribed)return b=!0,e.remove(c),W.remove(a,e.starting)},c=a(this.unsubscribe,d),this.unsubscribed||b||this.subscriptions.push(c),W.remove(a,this.starting),c},b.remove=function(a){return this.unsubscribed?void 0:void 0!==W.remove(a,this.subscriptions)?a():void 0},b.unsubscribe=function(){var a,b,c,d;if(!this.unsubscribed){for(this.unsubscribed=!0,a=0,c=(b=this.subscriptions).length;c>a;++a)d=b[a],d();return this.subscriptions=[],this.starting=[]}},b.count=function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},b.empty=function(){return 0===this.count()},a}(),d.CompositeUnsubscribe=y,z=function(){function a(a){this.value=a}a.displayName="Some";var b=a.prototype;return b.getOrElse=function(){return this.value},b.get=function(){return this.value},b.filter=function(b){return b(this.value)?new a(this.value):A},b.map=function(b){return new a(b(this.value))},b.forEach=function(a){return a(this.value)},b.isDefined=!0,b.toArray=function(){return[this.value]},a}(),A={getOrElse:function(a){return a},filter:function(){return A},map:function(){return A},forEach:function(){},isDefined:!1,toArray:function(){return[]}},d.EventStream=o,d.Property=p,d.Observable=m,d.Bus=v,d.Initial=j,d.Next=i,d.End=k,d.Error=l,B=function(){},C=function(a,b){return b()},D=function(a){return a},E=function(a){return new j(W.always(a))},F=function(a){return new i(W.always(a))},G=function(){return new k},H=function(a){return a instanceof h?a:F(a)},I=function(a){return a.slice(0)},J=Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:function(a,b){var c,d,e,f;for(c=0,d=a.length;d>c;++c)if(e=c,f=a[c],b===f)return e;return-1},K=function(a){return"function"==typeof a},L=function(a,b){return function(){var c;return c=X.call(arguments),a.apply(null,b.concat(c))}},M=function(a){return a instanceof m&&(a=W.always(a)),a},N=function(a){return a=Array.prototype.slice.call(a),O.apply(null,a)},O=f(function(a){var b;return b=X.call(arguments,1),K(a)?b.length?L(a,b):a:Q(a)?R(a,b):W.always(a)}),P=function(a,b){return O.apply(null,[a].concat(X.call(b)))},Q=function(a){return"string"==typeof a&&a.length>1&&"."===a.charAt(0)},d.isFieldKey=Q,R=function(a,b){var c,d;return c=a.slice(1).split("."),d=W.map(S(b),c),function(a){var b,c,e,f;for(b=0,e=(c=d).length;e>b;++b)f=c[b],a=f(a);return a}},S=function(a){return function(b){return function(c){var d;return null==c?void 0:(d=c[b],K(d)?d.apply(c,a):d)}}},T=function(a){return a.slice(1)},U=function(a){var b;return K(a)?a:Q(a)?(b=T(a),function(a,c){return a[b](c)}):void 0},V=function(a){return a instanceof z||a===A?a:new z(a)},W={head:function(a){return a[0]},always:function(a){return function(){return a}},negate:function(a){return function(b){return!a(b)}},empty:function(a){return 0===a.length},tail:function(a){return X.call(a,1,a.length)},filter:function(a,b){var c,d,e,f;for(c=[],d=0,e=b.length;e>d;++d)f=b[d],a(f)&&c.push(f);return c},map:function(a,b){var c,d,e,f=[];for(c=0,d=b.length;d>c;++c)e=b[c],f.push(a(e));return f},each:function(a,b){var c,d,e=[];for(c in a)d=a[c],e.push(b(c,d));return e},toArray:function(a){return a instanceof Array?a:[a]},contains:function(a,b){return-1!==J(a,b)},id:function(a){return a},last:function(a){return a[a.length-1]},all:function(a,b){var c,d,e;for(null==b&&(b=W.id),c=0,d=a.length;d>c;++c)if(e=a[c],!b(e))return!1;return!0},any:function(a,b){var c,d,e;for(null==b&&(b=W.id),c=0,d=a.length;d>c;++c)if(e=a[c],b(e))return!0;return!1},without:function(a,b){return W.filter(function(b){return b!==a},b)},remove:function(a,b){var c;return c=J(b,a),c>=0?b.splice(c,1):void 0},fold:function(a,b,c){var d,e,f;for(d=0,e=a.length;e>d;++d)f=a[d],b=c(b,f);return b},cached:function(){var a;return a=A,function(){var a,b;return a===A&&(a=b(),b=null),a}}},d._=W,d.scheduler={setTimeout:function(a,b){return setTimeout(a,b)},setInterval:function(a,b){return setInterval(a,b)},clearInterval:function(a){return clearInterval(a)},now:function(){return(new Date).getTime()}},"undefined"!=typeof module&&null!==module?(module.exports=d,d.Bacon=d):("undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],function(){return d}),this.Bacon=d)}).call(this);