// Generated by CoffeeScript 1.3.3
(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I=this,q={}.hasOwnProperty,R=function(e,t){function r(){this.constructor=e}for(var n in t)q.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},U=function(e,t){return function(){return e.apply(t,arguments)}},z=[].slice;(F=this.jQuery||this.Zepto)!=null&&(F.fn.asEventStream=function(t,n){var r;return r=this,new o(function(i){var s,o;return s=function(t){var n;n=i(O(t));if(n===e.noMore)return o()},o=function(){return r.off(t,n,s)},r.on(t,n,s),o})}),e=this.Bacon={},e.fromPromise=function(t){return new e.EventStream(function(e){var n,s;return s=function(t){return e(new a(t)),e(new r)},n=function(t){return e(new i(t)),e(new r)},t.then(s,n),M})},e.noMore="veggies",e.more="moar bacon!",e.never=function(){return new o(function(e){return function(){return M}})},e.later=function(t,n){return e.sequentially(t,[n])},e.sequentially=function(t,n){var r,i;return r=-1,i=function(){return r++,r<n.length?B(n[r]):g()},e.fromPoll(t,i)},e.repeatedly=function(t,n){var r,i;return r=-1,i=function(){return r++,B(n[r%n.length])},e.fromPoll(t,i)},e.fromPoll=function(t,n){return new o(function(r){var i,s,o;return s=void 0,i=function(){var t,i;i=n(),t=r(i);if(t===e.noMore||i.isEnd())return o()},o=function(){return clearInterval(s)},s=setInterval(i,t),o})},e.fromEventTarget=function(t,n){return new o(function(r){var i,s;return i=function(t){var n;n=r(O(t));if(n===e.noMore)return s()},t.addEventListener?(s=function(){return t.removeEventListener(n,i,!1)},t.addEventListener(n,i,!1)):(s=function(){return t.removeListener(n,i)},t.addListener(n,i)),s})},e.interval=function(t,n){var r;return n==null&&(n={}),r=function(){return O(n)},e.fromPoll(t,r)},e.constant=function(e){return new l(N(E,e))},e.once=function(e){return new o(N(O,e))},N=function(e,t){return function(n){return n(e(t)),n(g()),M}},e.combineAll=function(e,t){var n,r,i,s,o;r=w(e),o=P(e);for(i=0,s=o.length;i<s;i++)n=o[i],r=t(r,n);return r},e.mergeAll=function(t){return e.combineAll(t,function(e,t){return e.merge(t)})},e.combineAsArray=function(e){var t,n,r,i,s;n=w(e).toProperty().map(function(e){return[e]}),s=P(e);for(r=0,i=s.length;r<i;r++)t=s[r],n=n.combine(t,function(e,t){return e.concat([t])});return n},e.combineWith=function(t,n){return e.combineAll(t,function(e,t){return e.toProperty().combine(t,n)})},e.combineTemplate=function(t){var n,r,i,s,o,u,a,l;return u=[],l=[],o=function(e){return e[e.length-1]},a=function(e,t,n){return o(e)[t]=n},n=function(e,t){return function(n,r){return a(n,e,r[t])}},s=function(e,t){return function(n,r){return a(n,e,t)}},i=function(e){var t,r,o,c,h;h=[];for(t in e)c=e[t],c instanceof f?(l.push(c),h.push(u.push(n(t,l.length-1)))):typeof c=="object"?(o=function(e){return function(t,n){var r;return r={},a(t,e,r),t.push(r)}},r=function(e,t){return e.pop()},u.push(o(t)),i(c),h.push(u.push(r))):h.push(u.push(s(t,c)));return h},i(t),r=function(e){var t,n,r,i,s;r={},t=[r];for(i=0,s=u.length;i<s;i++)n=u[i],n(t,e);return r},e.combineAsArray(l).map(r)},e.latestValue=function(e){var t,n=this;return t=void 0,e.subscribe(function(e){if(e.hasValue())return t=e.value}),function(){return t}},s=function(){function e(){}return e.prototype.isEvent=function(){return!0},e.prototype.isEnd=function(){return!1},e.prototype.isInitial=function(){return!1},e.prototype.isNext=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.hasValue=function(){return!1},e.prototype.filter=function(e){return!0},e.prototype.getOriginalEvent=function(){return this.sourceEvent!=null?this.sourceEvent.getOriginalEvent():this},e.prototype.onDone=function(e){return e()},e}(),a=function(e){function t(e,t){this.value=e}return R(t,e),t.prototype.isNext=function(){return!0},t.prototype.hasValue=function(){return!0},t.prototype.fmap=function(e){return this.apply(e(this.value))},t.prototype.apply=function(e){return O(e,this.getOriginalEvent())},t.prototype.filter=function(e){return e(this.value)},t.prototype.describe=function(){return this.value},t}(s),u=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return R(t,e),t.prototype.isInitial=function(){return!0},t.prototype.isNext=function(){return!1},t.prototype.apply=function(e){return E(e,this.getOriginalEvent())},t}(a),r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return R(t,e),t.prototype.isEnd=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.describe=function(){return"<end>"},t}(s),i=function(e){function t(e){this.error=e}return R(t,e),t.prototype.isError=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.describe=function(){return"<error> "+this.error},t}(s),f=function(){function t(){this.takeUntil=U(this.takeUntil,this),this.assign=this.onValue}return t.prototype.onValue=function(){var e,t;return t=arguments[0],e=2<=arguments.length?z.call(arguments,1):[],t=k(t,e),this.subscribe(function(e){if(e.hasValue())return t(e.value)})},t.prototype.onError=function(){var e,t;return t=arguments[0],e=2<=arguments.length?z.call(arguments,1):[],t=k(t,e),this.subscribe(function(e){if(e.isError())return t(e.error)})},t.prototype.onEnd=function(){var e,t;return t=arguments[0],e=2<=arguments.length?z.call(arguments,1):[],t=k(t,e),this.subscribe(function(e){if(e.isEnd())return t()})},t.prototype.errors=function(){return this.filter(function(){return!1})},t.prototype.filter=function(){var t,n;return n=arguments[0],t=2<=arguments.length?z.call(arguments,1):[],n=k(n,t),this.withHandler(function(t){return t.filter(n)?this.push(t):e.more})},t.prototype.takeWhile=function(){var t,n;return n=arguments[0],t=2<=arguments.length?z.call(arguments,1):[],n=k(n,t),this.withHandler(function(t){return t.filter(n)?this.push(t):(this.push(g()),e.noMore)})},t.prototype.endOnError=function(){return this.withHandler(function(e){return e.isError()?(this.push(e),this.push(g())):this.push(e)})},t.prototype.take=function(t){return this.withHandler(function(n){return n.hasValue()?t===1?(this.push(n),this.push(g()),e.noMore):(t--,this.push(n)):this.push(n)})},t.prototype.map=function(){var e,t;return t=arguments[0],e=2<=arguments.length?z.call(arguments,1):[],t=k(t,e),this.withHandler(function(e){return this.push(e.fmap(t))})},t.prototype.mapError=function(){var e,t;return t=arguments[0],e=2<=arguments.length?z.call(arguments,1):[],t=k(t,e),this.withHandler(function(e){return e.isError()?this.push(O(t(e.error))):this.push(e)})},t.prototype["do"]=function(){var e,t;return t=arguments[0],e=2<=arguments.length?z.call(arguments,1):[],t=k(t,e),this.withHandler(function(e){return e.hasValue()&&t(e.value),this.push(e)})},t.prototype.takeUntil=function(t){var n;return n=this,this.withSubscribe(function(r){var i,s,o,u,a,f;return f=!1,u=M,a=M,o=function(){return u(),a(),f=!0},i=function(t){return t.isEnd()?(a(),r(t),e.noMore):(t.getOriginalEvent().onDone(function(){var n;if(!f){n=r(t);if(n===e.noMore)return o()}}),e.more)},s=function(t){return t.isError()?e.more:t.isEnd()?e.noMore:(u(),r(g()),e.noMore)},u=n.subscribe(i),f||(a=t.subscribe(s)),o})},t.prototype.skip=function(t){return this.withHandler(function(n){return n.hasValue()?t>0?(t--,e.more):this.push(n):this.push(n)})},t.prototype.distinctUntilChanged=function(){return this.skipDuplicates()},t.prototype.skipDuplicates=function(){return this.withStateMachine(void 0,function(e,t){return t.hasValue()?e!==t.value?[t.value,[t]]:[e,[]]:[e,[t]]})},t.prototype.withStateMachine=function(t,n){var r;return r=t,this.withHandler(function(t){var i,s,o,u,a,f,l;i=n(r,t),s=i[0],u=i[1],r=s,a=e.more;for(f=0,l=u.length;f<l;f++){o=u[f],a=this.push(o);if(a===e.noMore)return a}return a})},t.prototype.not=function(){return this.map(function(e){return!e})},t.prototype.log=function(){return this.subscribe(function(e){return console.log(e.describe())}),void 0},t}(),o=function(t){function r(e){this["switch"]=U(this["switch"],this);var t;r.__super__.constructor.call(this),t=new n(e),this.subscribe=t.subscribe,this.hasSubscribers=t.hasSubscribers}return R(r,t),r.prototype.map=function(){var e,t;return t=arguments[0],e=2<=arguments.length?z.call(arguments,1):[],t instanceof l?t.sampledBy(this,b):r.__super__.map.apply(this,[t].concat(z.call(e)))},r.prototype.filter=function(){var e,t;return t=arguments[0],e=2<=arguments.length?z.call(arguments,1):[],t instanceof l?t.sampledBy(this,function(e,t){return[e,t]}).filter(function(e){var t,n;return t=e[0],n=e[1],t}).map(function(e){var t,n;return t=e[0],n=e[1],n}):r.__super__.filter.apply(this,[t].concat(z.call(e)))},r.prototype.flatMap=function(t){var n;return n=this,new r(function(r){var i,s,o,u,a,f;return s=[],o=!1,f=function(){},a=function(){var e,t,n;f();for(t=0,n=s.length;t<n;t++)e=s[t],e();return s=[]},i=function(){if(o&&s.length===0)return r(g())},u=function(n){var u,f,l,c;return n.isEnd()?(o=!0,i()):n.isError()?r(n):(u=t(n.value),c=void 0,l=function(){return c!=null&&D(c,s),i()},f=function(t){var n;return t.isEnd()?(l(),e.noMore):(n=r(t),n===e.noMore&&a(),n)},c=u.subscribe(f),s.push(c))},f=n.subscribe(u),a})},r.prototype["switch"]=function(e){var t=this;return this.flatMap(function(n){return e(n).takeUntil(t)})},r.prototype.delay=function(t){return this.flatMap(function(n){return e.later(t,n)})},r.prototype.throttle=function(t){return this["switch"](function(n){return e.later(t,n)})},r.prototype.bufferWithTime=function(t){var n,r,i,s;return s=[],i=function(e){return s.push(e),s.length===1},r=function(){var e;return e=s,s=[],e},n=function(){return e.later(t).map(r)},this.filter(i).flatMap(n)},r.prototype.bufferWithCount=function(e){var t;return t=[],this.withHandler(function(n){var r,i=this;r=function(){return i.push(O(t,n)),t=[]};if(n.isError())return this.push(n);if(n.isEnd())return r(),this.push(n);t.push(n.value);if(t.length===e)return r()})},r.prototype.merge=function(t){var n;return n=this,new r(function(r){var i,s,o,u,a,f;return u=M,a=M,f=!1,o=function(){return u(),a(),f=!0},i=0,s=function(t){var n;return t.isEnd()?(i++,i===2?r(g()):e.more):(n=r(t),n===e.noMore&&o(),n)},u=n.subscribe(s),f||(a=t.subscribe(s)),o})},r.prototype.toProperty=function(e){return this.scan(e,C)},r.prototype.scan=function(t,r){var i,s,o,u;return r=H(r),i=t,o=function(e){return e.hasValue()&&(i=r(i,e.value)),this.push(e.apply(i))},s=new n(this.subscribe,o),u=function(t){var n;i!=null&&(n=t(E(i)));if(n!==e.noMore)return s.subscribe(t)},new l(u)},r.prototype.concat=function(e){var t;return t=this,new r(function(n){var r;return r=t.subscribe(function(t){return t.isEnd()?r=e.subscribe(n):n(t)}),function(){return r()}})},r.prototype.startWith=function(t){return e.once(t).concat(this)},r.prototype.decorateWith=function(e,t){return t.sampledBy(this,function(t,n){var r;return r=d(n),r[e]=t,r})},r.prototype.mapEnd=function(){var t,n;return n=arguments[0],t=2<=arguments.length?z.call(arguments,1):[],n=k(n,t),this.withHandler(function(t){return t.isEnd()?(this.push(O(n(t))),this.push(g()),e.noMore):this.push(t)})},r.prototype.withHandler=function(e){var t;return t=new n(this.subscribe,e),new r(t.subscribe)},r.prototype.withSubscribe=function(e){return new r(e)},r}(f),l=function(t){function n(t){var r,i=this;this.subscribe=t,this.toProperty=U(this.toProperty,this),this.changes=U(this.changes,this),this.sample=U(this.sample,this),n.__super__.constructor.call(this),r=function(t,r,s){var o,u;return o=void 0,u=void 0,new n(function(n){var a,f,l,c,h,p,d,v,m,y,b;return b=!1,m=M,y=M,v=function(){return m(),y(),b=!0},c=!1,p=!1,a=function(){var t;if(c&&p)return t=n(g()),t===e.noMore&&v(),t},l=!1,f=function(t,r,i){return function(s){var f;return s.isEnd()?(t(),a(),e.noMore):s.isError()?(f=n(s),f===e.noMore&&v,f):(r(s.value),o!=null&&u!=null?l&&s.isInitial()?e.more:(l=!0,f=i(n,s,o,u),f===e.noMore&&v,f):e.more)}},h=f(function(){return c=!0},function(e){return o=e},r),d=f(function(){return p=!0},function(e){return u=e},s),m=i.subscribe(h),b||(y=t.subscribe(d)),v})},this.combine=function(e,t){var n,i;return n=H(t),i=function(e,t,r,i){return e(t.apply(n(r,i)))},r(e,i,i)},this.sampledBy=function(e,t){var n;return t==null&&(t=b),t=H(t),n=function(e,n,r,i){return e(n.apply(t(r,i)))},r(e,M,n).changes().takeUntil(e.filter(!1).mapEnd())}}return R(n,t),n.prototype.sample=function(t){return this.sampledBy(e.interval(t,{}))},n.prototype.changes=function(){var e=this;return new o(function(t){return e.subscribe(function(e){if(!e.isInitial())return t(e)})})},n.prototype.withHandler=function(e){return new n((new c(this.subscribe,e)).subscribe)},n.prototype.withSubscribe=function(e){return new n((new c(e)).subscribe)},n.prototype.toProperty=function(){return this},n.prototype.and=function(e){return this.combine(e,function(e,t){return e&&t})},n.prototype.or=function(e){return this.combine(e,function(e,t){return e||t})},n}(f),n=function(){function t(t,n){var r,i,o,u=this;t==null&&(t=function(){return M}),i=[],this.hasSubscribers=function(){return i.length>0},o=M,r=function(e){return D(e,i)},this.push=function(t){var n,o,a,f,l,c,h;f=void 0,n=function(){var e,n,r,i;if(f!=null){n=f,f=void 0;for(r=0,i=n.length;r<i;r++)e=n[r],e()}return t.onDone=s.prototype.onDone},t.onDone=function(e){return f!=null&&!v(f,e)?f.push(e):f=[e]},h=p(i);for(l=0,c=h.length;l<c;l++)a=h[l],o=a(t),(o===e.noMore||t.isEnd())&&r(a);return n(),u.hasSubscribers()?e.more:e.noMore},n==null&&(n=function(e){return this.push(e)}),this.handleEvent=function(e){return e.isEnd()&&(t=function(){return M}),n.apply(u,[e])},this.subscribe=function(e){return i.push(e),i.length===1&&(o=t(u.handleEvent)),function(){r(e);if(!u.hasSubscribers())return o()}}}return t}(),c=function(t){function n(t,r){var i,s,o=this;n.__super__.constructor.call(this,t,r),i=void 0,s=this.push,t=this.subscribe,this.push=function(e){return e.hasValue()&&(i=e.value),s.apply(o,[e])},this.subscribe=function(n){var r;if(o.hasSubscribers()&&i!=null){r=n(E(i));if(r===e.noMore)return M}return t.apply(o,[n])}}return R(n,t),n}(n),t=function(t){function r(){var t,s,o,u,a,f,l,c,h,d=this;a=void 0,h=[],u=[],s=!1,o=function(t){return function(n){return n.isEnd()?(D(t,u),e.noMore):a(n)}},c=function(){var e,t,n;for(t=0,n=h.length;t<n;t++)e=h[t],e();return h=[]},f=function(e){var t,n,r,i;a=e,h=[],i=p(u);for(n=0,r=i.length;n<r;n++)t=i[n],h.push(t.subscribe(o(t)));return c},t=new n(f),l=function(e){return t.subscribe(e)},r.__super__.constructor.call(this,l),this.plug=function(e){if(s)return;u.push(e);if(a!=null)return h.push(e.subscribe(o(e)))},this.push=function(e){if(a!=null)return a(O(e))},this.error=function(e){if(a!=null)return a(new i(e))},this.end=function(){s=!0,c();if(a!=null)return a(g())}}return R(r,t),r}(o),e.EventStream=o,e.Property=l,e.Observable=f,e.Bus=t,e.Initial=u,e.Next=a,e.End=r,e.Error=i,M=function(){},C=function(e,t){return t},b=function(e,t){return e},E=function(e){return new u(e)},O=function(e){return new a(e)},g=function(){return new r},S=function(e){return e!=null&&e.isEvent!=null&&e.isEvent()},B=function(e){return S(e)?e:O(e)},m=function(e){return e.length===0},w=function(e){return e[0]},P=function(e){return e.slice(1,e.length)},y=function(e,t){var n,r,i,s;n=[];for(i=0,s=t.length;i<s;i++)r=t[i],e(r)&&n.push(r);return n},L=function(e,t){var n,r,i,s;s=[];for(r=0,i=t.length;r<i;r++)n=t[r],s.push(e(n));return s},p=function(e){return e.slice(0)},d=function(e){var t,n,r;t={};for(n in e)r=e[n],t[n]=r;return t},D=function(e,t){var n;n=t.indexOf(e);if(n>=0)return t.splice(n,1)},v=function(e,t){return e.indexOf(t)>=0},T=function(e){return typeof e=="function"},h=function(e){return function(){return e}},A=function(e,t,n){return n===void 0&&(n=[]),function(r){return e[t].apply(e,n.concat([r]))}},_=function(e,t){return function(n){return e.apply(null,t.concat([n]))}},k=function(e,t){var n;return T(e)?t.length?_(e,t):e:x(e)?(n=j(e),function(e){var r;return r=e[n],T(r)?e[n].apply(e,t):r}):typeof e=="object"&&t.length?A(e,w(t),P(t)):h(e)},x=function(e){return typeof e=="string"&&e.length>1&&e[0]==="."},j=function(e){return e.slice(1)},H=function(e){var t;if(T(e))return e;if(x(e))return t=j(e),function(e,n){return e[t](n)}},typeof define=="function"&&define(function(){return e})}).call(this);